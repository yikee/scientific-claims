<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Author Claim Annotation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f9fafb;
            color: #111827;
            line-height: 1.6;
        }
        
        .min-h-screen {
            min-height: 100vh;
        }
        
        .bg-gray-50 {
            background-color: #f9fafb;
        }
        
        .text-gray-900 {
            color: #111827;
        }
        
        .text-gray-600 {
            color: #4b5563;
        }
        
        .text-gray-700 {
            color: #374151;
        }
        
        .text-gray-800 {
            color: #1f2937;
        }
        
        .text-blue-700 {
            color: #1d4ed8;
        }
        
        .text-red-800 {
            color: #991b1b;
        }
        
        .text-green-700 {
            color: #15803d;
        }
        
        .text-amber-700 {
            color: #a16207;
        }
        
        .bg-white {
            background-color: #ffffff;
        }
        
        .bg-gray-100 {
            background-color: #f3f4f6;
        }
        
        .bg-red-50 {
            background-color: #fef2f2;
        }
        
        .bg-purple-900 {
            background-color: #581c87;
        }
        
        .bg-gray-900 {
            background-color: #111827;
        }
        
        .border {
            border: 1px solid #e5e7eb;
        }
        
        .border-b {
            border-bottom: 1px solid #e5e7eb;
        }
        
        .border-t {
            border-top: 1px solid #e5e7eb;
        }
        
        .border-gray-200 {
            border-color: #e5e7eb;
        }
        
        .border-red-200 {
            border-color: #fecaca;
        }
        
        .rounded {
            border-radius: 0.375rem;
        }
        
        .rounded-xl {
            border-radius: 0.75rem;
        }
        
        .shadow-sm {
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        
        .max-w-4xl {
            max-width: 56rem;
        }
        
        .mx-auto {
            margin-left: auto;
            margin-right: auto;
        }
        
        .px-4 {
            padding-left: 1rem;
            padding-right: 1rem;
        }
        
        .py-5 {
            padding-top: 1.25rem;
            padding-bottom: 1.25rem;
        }
        
        .py-6 {
            padding-top: 1.5rem;
            padding-bottom: 1.5rem;
        }
        
        .py-4 {
            padding-top: 1rem;
            padding-bottom: 1rem;
        }
        
        .py-1 {
            padding-top: 0.25rem;
            padding-bottom: 0.25rem;
        }
        
        .px-2 {
            padding-left: 0.5rem;
            padding-right: 0.5rem;
        }
        
        .px-3 {
            padding-left: 0.75rem;
            padding-right: 0.75rem;
        }
        
        .p-2 {
            padding: 0.5rem;
        }
        
        .p-3 {
            padding: 0.75rem;
        }
        
        .p-4 {
            padding: 1rem;
        }
        
        .mb-6 {
            margin-bottom: 1.5rem;
        }
        
        .mb-4 {
            margin-bottom: 1rem;
        }
        
        .mb-2 {
            margin-bottom: 0.5rem;
        }
        
        .mb-10 {
            margin-bottom: 2.5rem;
        }
        
        .mt-2 {
            margin-top: 0.5rem;
        }
        
        .mt-3 {
            margin-top: 0.75rem;
        }
        
        .gap-2 {
            gap: 0.5rem;
        }
        
        .gap-3 {
            gap: 0.75rem;
        }
        
        .h-9 {
            height: 2.25rem;
        }
        
        .w-9 {
            width: 2.25rem;
        }
        
        .h-4 {
            height: 1rem;
        }
        
        .w-4 {
            width: 1rem;
        }
        
        .min-h-5rem {
            min-height: 5rem;
        }
        
        .min-h-4rem {
            min-height: 4rem;
        }
        
        .text-lg {
            font-size: 1.125rem;
            line-height: 1.75rem;
        }
        
        .text-sm {
            font-size: 0.875rem;
            line-height: 1.25rem;
        }
        
        .text-xs {
            font-size: 0.75rem;
            line-height: 1rem;
        }
        
        .text-base {
            font-size: 1rem;
            line-height: 1.5rem;
        }
        
        .text-lg-textarea {
            font-size: 1rem;
            line-height: 1.5rem;
        }
        
        .font-semibold {
            font-weight: 600;
        }
        
        .font-medium {
            font-weight: 500;
        }
        
        .font-bold {
            font-weight: 700;
        }
        
        .leading-relaxed {
            line-height: 1.625;
        }
        
        .flex {
            display: flex;
        }
        
        .flex-col {
            flex-direction: column;
        }
        
        .items-center {
            align-items: center;
        }
        
        .items-start {
            align-items: flex-start;
        }
        
        .justify-between {
            justify-content: space-between;
        }
        
        .justify-end {
            justify-content: flex-end;
        }
        
        .flex-1 {
            flex: 1 1 0%;
        }
        
        .grid {
            display: grid;
        }
        
        .place-items-center {
            place-items: center;
        }
        
        .space-y-3 > * + * {
            margin-top: 0.75rem;
        }
        
        .list-disc {
            list-style-type: disc;
        }
        
        .list-inside {
            list-style-position: inside;
        }
        
        .pl-5 {
            padding-left: 1.25rem;
        }
        
        .underline {
            text-decoration: underline;
        }
        
        .hover\:bg-gray-50:hover {
            background-color: #f9fafb;
        }
        
        .hover\:bg-black:hover {
            background-color: #000000;
        }
        
        .hover\:bg-gray-50:hover {
            background-color: #f9fafb;
        }
        
        .disabled\:opacity-50:disabled {
            opacity: 0.5;
        }
        
        .opacity-50 {
            opacity: 0.5;
        }
        
        .text-white {
            color: #ffffff;
        }
        
        .text-gray-500 {
            color: #6b7280;
        }
        
        .w-full {
            width: 100%;
        }
        
        .inline-flex {
            display: inline-flex;
        }
        
        button {
            cursor: pointer;
            border: none;
            outline: none;
        }
        
        button:disabled {
            cursor: not-allowed;
        }
        
        input[type="radio"], input[type="checkbox"] {
            cursor: pointer;
        }
        
        textarea {
            resize: vertical;
            font-family: inherit;
        }
        
        a {
            color: inherit;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        @media (min-width: 640px) {
            .sm\:flex-row {
                flex-direction: row;
            }
            .sm\:w-32 {
                width: 8rem;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- React and Babel for JSX support -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel" data-presets="typescript,react">
        // ---- Collector config + helper (PUT THIS NEAR THE TOP, OUTSIDE THE COMPONENT)
        const COLLECT_URL = "https://script.google.com/macros/s/AKfycbxGtX2N3-6PhpWg9V9ITQrgwQdXAS7ZnlXUfTzHFSfMCVnLuy8b_uepwcvLl2Cpo_yZ9w/exec"; // your Apps Script URL
        const SHARED_SECRET = "fw84"; // optional; must match the script if you set one

        async function submitToSheet(payload) {
            // "text/plain" keeps it a simple request (no CORS preflight)
            const res = await fetch(COLLECT_URL, {
                method: "POST",
                headers: { "Content-Type": "text/plain;charset=utf-8" },
                body: JSON.stringify({ ...payload, key: SHARED_SECRET }),
            });
            const data = await res.json().catch(() => ({}));
            if (!res.ok || data.ok !== true) throw new Error("Submit failed");
        }

        // Download JSON function
        function downloadJSON(payload) {
            const blob = new Blob([JSON.stringify(payload, null, 2)], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "claim-annotations.json";
            a.click();
            URL.revokeObjectURL(url);
        }

        // 1) A small registry of content keyed by id
        const CONTENT = {
            qlora: {
                paper: {
                    title: "QLoRA: Efficient Finetuning of Quantized LLMs",
                    publicationDate: "2023-05-23",
                    url: "https://www.semanticscholar.org/paper/32ac52069e562d4f900afee70bdca63f53461481",
                    abstract: "We present QLoRA, an efficient finetuning approach that reduces memory usage enough to finetune a 65B parameter model on a single 48GB GPU while preserving full 16-bit finetuning task performance. QLoRA backpropagates gradients through a frozen, 4-bit quantized pretrained language model into Low Rank Adapters~(LoRA). Our best model family, which we name Guanaco, outperforms all previous openly released models on the Vicuna benchmark, reaching 99.3% of the performance level of ChatGPT while only requiring 24 hours of finetuning on a single GPU. QLoRA introduces a number of innovations to save memory without sacrificing performance: (a) 4-bit NormalFloat (NF4), a new data type that is information theoretically optimal for normally distributed weights (b) double quantization to reduce the average memory footprint by quantizing the quantization constants, and (c) paged optimziers to manage memory spikes. We use QLoRA to finetune more than 1,000 models, providing a detailed analysis of instruction following and chatbot performance across 8 instruction datasets, multiple model types (LLaMA, T5), and model scales that would be infeasible to run with regular finetuning (e.g. 33B and 65B parameter models). Our results show that QLoRA finetuning on a small high-quality dataset leads to state-of-the-art results, even when using smaller models than the previous SoTA. We provide a detailed analysis of chatbot performance based on both human and GPT-4 evaluations showing that GPT-4 evaluations are a cheap and reasonable alternative to human evaluation. Furthermore, we find that current chatbot benchmarks are not trustworthy to accurately evaluate the performance levels of chatbots. A lemon-picked analysis demonstrates where Guanaco fails compared to ChatGPT. We release all of our models and code, including CUDA kernels for 4-bit training."
                },
                claims: [
                    { id: "c1", source: "synthetic", text: "QLoRA enables full-performance finetuning of 65B-parameter language models on a single 48 GB GPU by using 4-bit quantization and low-rank adapters.", label: "support", status: null },
                    { id: "c2", source: "synthetic", text: "QLoRA reduces the inference time of 65B-parameter language models compared to standard finetuning approaches.", label: "refute", status: null }
                ]
            },
            modelswarms: {
                paper: {
                    title: "Model Swarms: Collaborative Search to Adapt LLM Experts via Swarm Intelligence",
                    publicationDate: "2024-10-15",
                    url: "https://www.semanticscholar.org/paper/492d4d5c7341ae63abdcb044b073dfd59e2a8ee3",
                    abstract: "We propose Model Swarms, a collaborative search algorithm to adapt LLMs via swarm intelligence, the collective behavior guiding individual systems. Specifically, Model Swarms starts with a pool of LLM experts and a utility function. Guided by the best-found checkpoints across models, diverse LLM experts collaboratively move in the weight space and optimize a utility function representing model adaptation objectives. Compared to existing model composition approaches, Model Swarms offers tuning-free model adaptation, works in low-data regimes with as few as 200 examples, and does not require assumptions about specific experts in the swarm or how they should be composed. Extensive experiments demonstrate that Model Swarms could flexibly adapt LLM experts to a single task, multi-task domains, reward models, as well as diverse human interests, improving over 12 model composition baselines by up to 21.0% across tasks and contexts. Further analysis reveals that LLM experts discover previously unseen capabilities in initial checkpoints and that Model Swarms enable the weak-to-strong transition of experts through the collaborative search process."
                },
                claims: [
                    { id: "c1", source: "synthetic", text: "Model Swarms enable tuning-free, collaborative LLM adaptation via swarm intelligence, outperforming baselines by up to 21% with minimal data.", label: "support", status: null },
                    { id: "c2", source: "synthetic", text: "Model Swarms improve LLM performance by incorporating real-time human feedback during the collaborative adaptation process.", label: "refute", status: null }
                ]
            },
            selfinstruct: {
                paper: {
                    title: "Self-Instruct: Aligning Language Models with Self-Generated Instructions",
                    publicationDate: "2022-12-20",
                    url: "https://www.semanticscholar.org/paper/e65b346d442e9962a4276dc1c1af2956d9d5f1eb",
                    abstract: "Large “instruction-tuned” language models (i.e., finetuned to respond to instructions) have demonstrated a remarkable ability to generalize zero-shot to new tasks. Nevertheless, they depend heavily on human-written instruction data that is often limited in quantity, diversity, and creativity, therefore hindering the generality of the tuned model. We introduce Self-Instruct, a framework for improving the instruction-following capabilities of pretrained language models by bootstrapping off their own generations. Our pipeline generates instructions, input, and output samples from a language model, then filters invalid or similar ones before using them to finetune the original model. Applying our method to the vanilla GPT3, we demonstrate a 33% absolute improvement over the original model on Super-NaturalInstructions, on par with the performance of InstructGPT-001, which was trained with private user data and human annotations. For further evaluation, we curate a set of expert-written instructions for novel tasks, and show through human evaluation that tuning GPT3 with Self-Instruct outperforms using existing public instruction datasets by a large margin, leaving only a 5% absolute gap behind InstructGPT-001. Self-Instruct provides an almost annotation-free method for aligning pre-trained language models with instructions, and we release our large synthetic dataset to facilitate future studies on instruction tuning."
                },
                claims: [
                    { id: "c1", source: "synthetic", text: "Self-Instruct improves instruction-following capabilities of pretrained LLMs (e.g., GPT-3) by bootstrapping from their own generations, achieving performance near InstructGPT-001 without human-annotated data.", label: "support", status: null },
                    { id: "c2", source: "synthetic", text: "Self-Instruct enhances model alignment by incorporating human-in-the-loop feedback during instruction generation.", label: "refute", status: null }
                ]
            },
            metaphor: {
                paper: {
                    title: "Metaphor Detection with Cross-Lingual Model Transfer",
                    publicationDate: "2014-06-01",
                    url: "https://www.semanticscholar.org/paper/ef1d93b03c20b2f488b66e8e2c24fceb2105d58f",
                    abstract: "We show that it is possible to reliably discriminate whether a syntactic construction is meant literally or metaphorically using lexical semantic features of the words that participate in the construction. Our model is constructed using English resources, and we obtain state-of-the-art performance relative to previous work in this language. Using a model transfer approach by pivoting through a bilingual dictionary, we show our model can identify metaphoric expressions in other languages. We provide results on three new test sets in Spanish, Farsi, and Russian. The results support the hypothesis that metaphors are conceptual, rather than lexical, in nature."
                },
                claims: [
                    { id: "c1", source: "synthetic", text: "Lexical semantic features enable reliable discrimination between literal and metaphorical uses of syntactic constructions, achieving state-of-the-art performance in English.", label: "support", status: null },
                    { id: "c2", source: "synthetic", text: "The feature-based lexical semantic classification model replicates the cognitive processes humans use to distinguish between literal and metaphorical language.", label: "refute", status: null } 
                ]
            }
        };

        // 2) Helpers to read the current id and content
        function getIdFromURL() {
            const params = new URLSearchParams(window.location.search);
            return params.get("id") || "qlora"; // default if missing
        }
        function getContentById(id) {
            return CONTENT[id] || null;
        }

        // ClaimAnnotationApp React component
        function ClaimAnnotationApp({ initialPaper, initialClaims }) {
            const [paper] = React.useState(initialPaper);
            const [claims, setClaims] = React.useState(initialClaims);
            const [comments, setComments] = React.useState("");
            const [consent, setConsent] = React.useState(false);
            const [saving, setSaving] = React.useState("idle");
            const [draftAccepted, setDraftAccepted] = React.useState({
                mainSupported: null, // null = not selected, true = yes, false = no
                relevantUnsupported: null
            });

            const handleClaimChange = (index, value) => {
                const newClaims = [...claims];
                newClaims[index] = { ...newClaims[index], editedText: value, status: "edited" };
                setClaims(newClaims);
            };

            const handleAcceptClaim = (index, checked) => {
                const newClaims = [...claims];
                if (checked) {
                    newClaims[index] = { ...newClaims[index], status: "accepted", editedText: undefined };
                } else {
                    newClaims[index] = { ...newClaims[index], status: null };
                }
                setClaims(newClaims);
            };

            const handleDraftSelection = (claimType, accepted) => {
                setDraftAccepted(prev => ({
                    ...prev,
                    [claimType]: accepted
                }));
                
                // If they accept the draft, mark it as accepted
                const index = claimType === 'mainSupported' ? 0 : 1;
                const newClaims = [...claims];
                if (accepted) {
                    newClaims[index] = { ...newClaims[index], status: "accepted", editedText: undefined };
                } else {
                    newClaims[index] = { ...newClaims[index], status: null };
                }
                setClaims(newClaims);
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!consent) return;

                const payload = {
                    paper, claims, comments, consent,
                    timestamp: new Date().toISOString(),
                };

                setSaving("saving");
                try {
                    await submitToSheet(payload);
                    setSaving("ok");
                } catch (err) {
                    setSaving("err");
                    downloadJSON(payload);
                }
            };

            return (
                <div className="min-h-screen bg-gray-50 text-gray-900">
                    <header className="border-b bg-white">
                        <div className="max-w-4xl mx-auto px-4 py-5 flex items-center gap-3">
                            <div className="h-9 w-9 rounded bg-purple-900 text-white grid place-items-center font-bold">UW</div>
                            <div>
                                <h1 className="text-lg font-semibold">Scientific Claim Annotation</h1>
                                <p className="text-sm text-gray-600">University of Washington</p>
                            </div>
                        </div>
                    </header>
                    
                    <main className="max-w-4xl mx-auto px-4 py-6">
                        {/* Overview Section */}
                        <section className="mb-6">
                            <h2 className="text-lg font-semibold text-gray-900 mb-2">Overview</h2>
                            <div className="bg-white border border-gray-200 rounded-xl p-4 shadow-sm">
                                <p className="text-base leading-relaxed mb-2">Thank you for participating in our study!</p>
                                <p className="text-base mb-2">We invite you to provide two scientific claims about your paper:</p>
                                <ul className="list-disc list-inside text-base mb-2">
                                    <li><strong>Main supported claim</strong>: The central scientific claim that is uniquely supported by your paper's findings.</li>
                                    <li><strong>Relevant but unsupported claim</strong>: A scientific claim that is related to the topic of your paper, but which your paper does not support.</li>
                                </ul>
                                <p className="text-base mb-2"><i>Note</i>: A <u>scientific claim</u> is a atomic verifiable statements expressing a finding about one aspect of a scientific entity or process, which can be verified against a single source. Each claim should be around 20 words in length.</p>
                                <p className="text-base mb-2">We draft both claims for you. Please feel free to edit, refine, or rewrite them as needed, or accept the draft claims if they fully satisfy the requirements.</p>
                                {/* <p className="text-sm text-gray-600 mt-2">A <u>scientific claim</u> is a atomic verifiable statements expressing a finding about one aspect of a scientific entity or process, which can be verified against a single source.</p> */}
                            </div>
                        </section>
                        
                        {/* Paper Information Section */}
                        <section className="mb-6">
                            <h2 className="text-lg font-semibold text-gray-900 mb-2">Paper Information</h2>
                            <div className="bg-white border border-gray-200 rounded-xl p-4 shadow-sm">
                                <div className="flex flex-col sm:flex-row gap-2 py-1">
                                    <div className="sm:w-32 text-gray-600">Title</div>
                                    <div className="flex-1">
                                        <div className="font-medium">{paper.title}</div>
                                    </div>
                                </div>
                                <div className="flex flex-col sm:flex-row gap-2 py-1">
                                    <div className="sm:w-32 text-gray-600">Publication Date</div>
                                    <div className="flex-1">
                                        <div>{paper.publicationDate}</div>
                                    </div>
                                </div>
                                <div className="flex flex-col sm:flex-row gap-2 py-1">
                                    <div className="sm:w-32 text-gray-600">Link</div>
                                    <div className="flex-1">
                                        <div><a className="text-blue-700 underline" href={paper.url} target="_blank">Semantic Scholar</a></div>
                                    </div>
                                </div>
                                <div className="flex flex-col sm:flex-row gap-2 py-1">
                                    <div className="sm:w-32 text-gray-600">Abstract</div>
                                    <div className="flex-1">
                                        <p className="text-sm text-gray-800 leading-relaxed">{paper.abstract}</p>
                                    </div>
                                </div>
                            </div>
                        </section>
                        
                        {/* Main Supported Claim Section */}
                        <section className="mb-6">
                            <h2 className="text-lg font-semibold text-gray-900 mb-2">Main supported claim</h2>
                            <div className="bg-white border border-gray-200 rounded-xl p-4 shadow-sm">
                                <div className="mb-6">
                                    {/* Show draft claim first */}
                                    <div className="mb-4">
                                        <p className="text-sm text-gray-600 mb-2">Draft claim:</p>
                                        <div className="bg-gray-50 border rounded p-3 mb-3">
                                            <p className="text-base text-gray-800">{claims[0]?.text}</p>
                                        </div>
                                        <div className="flex justify-end mb-3">
                                            <p className="text-xs text-gray-500">draft claims are generated by GPT-4o</p>
                                        </div>
                                        
                                        {/* Yes/No selection */}
                                        <div className="mb-4">
                                            <p className="text-sm text-gray-700 mb-2">Is this the main claim that your paper uniquely supports?</p>
                                            <div className="flex gap-8">
                                                <label className="flex items-center gap-3">
                                                    <input
                                                        type="radio"
                                                        name="mainSupportedDraft"
                                                        className="h-4 w-4"
                                                        checked={draftAccepted.mainSupported === true}
                                                        onChange={() => handleDraftSelection('mainSupported', true)}
                                                    />
                                                    <span className="text-sm text-gray-700">Yes</span>
                                                </label>
                                                <label className="flex items-center gap-3">
                                                    <input
                                                        type="radio"
                                                        name="mainSupportedDraft"
                                                        className="h-4 w-4"
                                                        checked={draftAccepted.mainSupported === false}
                                                        onChange={() => handleDraftSelection('mainSupported', false)}
                                                    />
                                                    <span className="text-sm text-gray-700">No</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {/* Show editable textarea only if they selected "No" */}
                                    {draftAccepted.mainSupported === false && (
                                        <div>
                                            <p className="text-sm text-gray-700 mb-2">Please provide your main supported claim:</p>
                                            <textarea
                                                className="w-full min-h-5rem rounded border p-2 text-gray-500 text-base"
                                                placeholder="Enter your main supported claim here..."
                                                value={claims[0]?.editedText || claims[0]?.text || ""}
                                                onChange={(e) => handleClaimChange(0, e.target.value)}
                                            />
                                        </div>
                                    )}
                                </div>
                            </div>
                        </section>
                        
                        {/* Relevant but Unsupported Claim Section */}
                        <section className="mb-6">
                            <h2 className="text-lg font-semibold text-gray-900 mb-2">Relevant but unsupported claim</h2>
                            <div className="bg-white border border-gray-200 rounded-xl p-4 shadow-sm">
                                <div className="mb-6">
                                    {/* Show draft claim first */}
                                    <div className="mb-4">
                                        <p className="text-sm text-gray-600 mb-2">Draft claim:</p>
                                        <div className="bg-gray-50 border rounded p-3 mb-3">
                                            <p className="text-base text-gray-800">{claims[1]?.text}</p>
                                        </div>
                                        <div className="flex justify-end mb-3">
                                            <p className="text-xs text-gray-500">draft claims are generated by GPT-4o</p>
                                        </div>
                                        
                                        {/* Yes/No selection */}
                                        <div className="mb-4">
                                            <p className="text-sm text-gray-700 mb-2">Is this a relevant but unsupported claim?</p>
                                            <div className="flex gap-8">
                                                <label className="flex items-center gap-3">
                                                    <input
                                                        type="radio"
                                                        name="relevantUnsupportedDraft"
                                                        className="h-4 w-4"
                                                        checked={draftAccepted.relevantUnsupported === true}
                                                        onChange={() => handleDraftSelection('relevantUnsupported', true)}
                                                    />
                                                    <span className="text-sm text-gray-700">Yes</span>
                                                </label>
                                                <label className="flex items-center gap-3">
                                                    <input
                                                        type="radio"
                                                        name="relevantUnsupportedDraft"
                                                        className="h-4 w-4"
                                                        checked={draftAccepted.relevantUnsupported === false}
                                                        onChange={() => handleDraftSelection('relevantUnsupported', false)}
                                                    />
                                                    <span className="text-sm text-gray-700">No</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {/* Show editable textarea only if they selected "No" */}
                                    {draftAccepted.relevantUnsupported === false && (
                                        <div>
                                            <p className="text-sm text-gray-700 mb-2">Please provide your relevant but unsupported claim:</p>
                                            <textarea
                                                className="w-full min-h-5rem rounded border p-2 text-gray-500 text-base"
                                                placeholder="Enter your relevant but unsupported claim here..."
                                                value={claims[1]?.editedText || claims[1]?.text || ""}
                                                onChange={(e) => handleClaimChange(1, e.target.value)}
                                            />
                                        </div>
                                    )}
                                </div>
                            </div>
                        </section>
                        
                        {/* Comments Section */}
                        <section className="mb-6">
                            <h2 className="text-lg font-semibold text-gray-900 mb-2">Comments (optional)</h2>
                            <div className="bg-white border border-gray-200 rounded-xl p-4 shadow-sm">
                                <textarea 
                                    placeholder="Any feedback or questions?" 
                                    className="w-full min-h-4rem rounded border p-2 text-base"
                                    value={comments}
                                    onChange={(e) => setComments(e.target.value)}
                                />
                            </div>
                        </section>
                        
                        {/* Consent & Submit Section */}
                        <form onSubmit={handleSubmit} className="mb-10">
                            <section className="mb-6">
                                <h2 className="text-lg font-semibold text-gray-900 mb-2">Consent & Submit</h2>
                                <div className="bg-white border border-gray-200 rounded-xl p-4 shadow-sm">
                                    <div className="space-y-3">
                                        <div className="flex items-start gap-3">
                                            <input 
                                                type="checkbox" 
                                                className="mt-2 h-4 w-4" 
                                                checked={consent}
                                                onChange={(e) => setConsent(e.target.checked)}
                                            />
                                            <label className="text-base">I understand my annotations will be used for research purposes and I will not submit any sensitive or confidential information. I will be acknowledged for my contributions.</label>
                                        </div>
                                        <div className="flex gap-3 items-center">
                                            <button 
                                                type="submit" 
                                                className="px-4 py-2 rounded bg-gray-900 text-white hover:bg-black disabled:opacity-50 text-base"
                                                disabled={saving === "saving"}
                                            >
                                                {saving === "saving" ? "Submitting..." : "Submit"}
                                            </button>
                                            {saving === "ok" && <span className="text-sm text-green-700">Saved ✓</span>}
                                            {saving === "err" && <span className="text-sm text-amber-700">Couldn't reach server; downloaded a backup JSON.</span>}
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </form>
                    </main>
                    
                    <footer className="border-t bg-white">
                        <div className="max-w-4xl mx-auto px-4 py-4 text-xs text-gray-600">© UW — Scientific Claim Annotation Study.</div>
                    </footer>
                </div>
            );
        }

        // 3) A small wrapper that reacts to URL changes (back/forward)
        function AppRouter() {
            const [id, setId] = React.useState(getIdFromURL());
            React.useEffect(() => {
                const onPop = () => setId(getIdFromURL());
                window.addEventListener("popstate", onPop);
                return () => window.removeEventListener("popstate", onPop);
            }, []);

            const cfg = getContentById(id);
            if (!cfg) {
                return (
                    <div className="max-w-4xl mx-auto px-4 py-10">
                        <div className="border rounded-lg p-4 bg-yellow-50 border-yellow-200 text-yellow-900">
                            Unknown id: <b>{id}</b>.
                        </div>
                    </div>
                );
            }
            return <ClaimAnnotationApp initialPaper={cfg.paper} initialClaims={cfg.claims} />;
        }

        // 4) Mount the router (instead of mounting ClaimAnnotationApp directly)
        const root = ReactDOM.createRoot(document.getElementById("root"));
        root.render(<AppRouter />);
    </script>

</body>
</html>
